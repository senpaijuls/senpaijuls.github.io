<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love Letters for Shane, My Love</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #ffc3d5 0%, #ffe5ec 50%, #fff 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .tulip {
            position: fixed;
            font-size: 60px;
            opacity: 0.4;
            animation: float 15s infinite ease-in-out;
            z-index: 1;
            pointer-events: none;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            25% {
                transform: translateY(-30px) rotate(5deg);
            }
            50% {
                transform: translateY(-60px) rotate(-5deg);
            }
            75% {
                transform: translateY(-30px) rotate(3deg);
            }
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 2;
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
            animation: fadeInDown 1s ease;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header h1 {
            color: #d63384;
            font-size: 3.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(214, 51, 132, 0.2);
        }

        .header p {
            color: #c2185b;
            font-size: 1.3em;
            font-style: italic;
        }

        .letter-container {
            background: white;
            border-radius: 20px;
            padding: 50px;
            margin-bottom: 40px;
            box-shadow: 0 10px 40px rgba(214, 51, 132, 0.15);
            position: relative;
            overflow: hidden;
            animation: fadeIn 1s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .letter-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(90deg, #ff69b4, #d63384, #c2185b);
        }

        .letter-date {
            color: #d63384;
            font-size: 0.9em;
            margin-bottom: 20px;
            font-style: italic;
        }

        .letter-content {
            color: #333;
            line-height: 1.8;
            font-size: 1.1em;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .heart-divider {
            text-align: center;
            margin: 30px 0;
            color: #ff69b4;
            font-size: 2em;
        }

        .add-letter-btn {
            background: linear-gradient(135deg, #ff69b4, #d63384);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            display: block;
            margin: 40px auto;
            box-shadow: 0 5px 20px rgba(214, 51, 132, 0.3);
            transition: all 0.3s ease;
        }

        .add-letter-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(214, 51, 132, 0.4);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: white;
            max-width: 600px;
            margin: 50px auto;
            padding: 40px;
            border-radius: 20px;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 30px;
            color: #d63384;
            cursor: pointer;
            border: none;
            background: none;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #d63384;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ffc3d5;
            border-radius: 10px;
            font-family: 'Georgia', serif;
            font-size: 1em;
        }

        .form-group textarea {
            min-height: 200px;
            resize: vertical;
        }

        .submit-btn {
            background: linear-gradient(135deg, #ff69b4, #d63384);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }

        .delete-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            background: #ee5a6f;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5em;
            }
            .letter-container {
                padding: 30px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Love Letters</h1>
            <p>A collection of my heart's whispers</p>
        </div>

        <div id="letters-display"></div>

        <button class="add-letter-btn" onclick="openModal()">‚úçÔ∏è Write a New Letter</button>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <h2 style="color: #d63384; margin-bottom: 20px;">Write Your Heart Out</h2>
            <form id="letter-form">
                <div class="form-group">
                    <label>Date:</label>
                    <input type="text" id="letter-date" required>
                </div>
                <div class="form-group">
                    <label>Your Love Letter:</label>
                    <textarea id="letter-text" placeholder="Dear love..." required></textarea>
                </div>
                <button type="submit" class="submit-btn">üíå Save Letter</button>
            </form>
        </div>
    </div>

    <script>
        // Create animated tulips
        function createTulips() {
            const tulipEmojis = ['üå∑', 'üåπ', 'üíê'];
            for (let i = 0; i < 15; i++) {
                const tulip = document.createElement('div');
                tulip.className = 'tulip';
                tulip.textContent = tulipEmojis[Math.floor(Math.random() * tulipEmojis.length)];
                tulip.style.left = Math.random() * 100 + '%';
                tulip.style.top = Math.random() * 100 + '%';
                tulip.style.animationDelay = Math.random() * 5 + 's';
                tulip.style.animationDuration = (10 + Math.random() * 10) + 's';
                document.body.appendChild(tulip);
            }
        }

        // Persistent storage for letters using window.storage
        let letters = [];

        // Load letters from storage
        async function loadLetters() {
            try {
                const result = await window.storage.get('love-letters');
                if (result && result.value) {
                    letters = JSON.parse(result.value);
                } else {
                    // Default sample letter if no letters exist
                    letters = [
                        {
                            date: "January 11, 2026",
                            content: "My dearest love,\n\nEvery moment with you feels like a beautiful dream I never want to wake up from. Your smile lights up my world, and your laughter is the sweetest melody I've ever heard.\n\nI am so grateful for every second we share together. You make me a better person, and I fall more in love with you each day.\n\nForever yours,\nWith all my heart üíï"
                        }
                    ];
                    await saveLetters();
                }
            } catch (error) {
                console.log('No existing letters found, starting fresh');
                letters = [
                    {
                        date: "January 11, 2026",
                        content: "My dearest love,\n\nEvery moment with you feels like a beautiful dream I never want to wake up from. Your smile lights up my world, and your laughter is the sweetest melody I've ever heard.\n\nI am so grateful for every second we share together. You make me a better person, and I fall more in love with you each day.\n\nForever yours,\nWith all my heart üíï"
                    }
                ];
                await saveLetters();
            }
            displayLetters();
        }

        // Save letters to storage
        async function saveLetters() {
            try {
                await window.storage.set('love-letters', JSON.stringify(letters));
            } catch (error) {
                console.error('Error saving letters:', error);
                alert('There was an error saving your letter. Please try again.');
            }
        }

        function displayLetters() {
            const display = document.getElementById('letters-display');
            display.innerHTML = '';
            
            letters.forEach((letter, index) => {
                const letterDiv = document.createElement('div');
                letterDiv.className = 'letter-container';
                letterDiv.innerHTML = `
                    <div class="letter-date">${letter.date}</div>
                    <div class="letter-content">${letter.content}</div>
                    <button class="delete-btn" onclick="deleteLetter(${index})">Delete Letter</button>
                `;
                display.appendChild(letterDiv);

                if (index < letters.length - 1) {
                    const divider = document.createElement('div');
                    divider.className = 'heart-divider';
                    divider.textContent = 'üíù';
                    display.appendChild(divider);
                }
            });
        }

        function openModal() {
            document.getElementById('modal').style.display = 'block';
            document.getElementById('letter-date').value = new Date().toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            document.getElementById('letter-form').reset();
        }

        function deleteLetter(index) {
            if (confirm('Are you sure you want to delete this letter?')) {
                letters.splice(index, 1);
                saveLetters();
                displayLetters();
            }
        }

        document.getElementById('letter-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const date = document.getElementById('letter-date').value;
            const content = document.getElementById('letter-text').value;
            
            letters.push({ date, content });
            await saveLetters();
            displayLetters();
            closeModal();
        });

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Initialize
        createTulips();
        loadLetters();
    </script>
</body>
</html>
